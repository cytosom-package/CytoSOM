#'
#' Selective naming of metaclustesters according to specific markers expression
#' @param TreeMetaCl Object generated by the function BuildFSOMTree
#' @param Markers Markers choosen for the naming
#' @param NameType Type of name applied
#' @return BuildFSOMTree object with the metaclusters renamed with the choosen name type, keeping the metacluster numbers
#' @export


TreeMetaRenaming<-function(TreeMetaCl,Markers,NameType){
  if (is.null(TreeMetaCl$gatingName)) {gName = ""} else
  {gName=TreeMetaCl4Rename$gatingName}
  Namings=MetaClusterNaming(TreeMetaCl,Markers)
  return(list(fSOMTree=TreeMetaCl$fSOMTree,
              metaClNumber=TreeMetaCl$metaCl,
              metaCl=
                sapply(TreeMetaCl$metaCl,function(x){paste(Namings$number[which(Namings$number == x)],
                                                                       Namings$option[which(Namings$number == x)],sep="_")}),
              gatingName=gName))
  }
