#' 
#' Selective naming of metaclustesters according to specific markers expression
#' @param TreeMetaCl Object generated by the function BuildFSOMTree
#' @param Markers Markers choosen for the naming
#' @param NameType Type of name applied
#' @return BuildFSOMTree object with the metaclusters renamed with the choosen name type
#' @export 


TreeMetaRenaming<-function(TreeMetaCl,Markers,NameType){
  
  TreeMetaCl4Rename=TreeMetaCl
  gatingName=TreeMetaCl4Rename$gatingName
  TreeMetaCl4Rename$metaClNumber=TreeMetaCl4Rename$metaCl
  Namings=MetaClusterNaming(TreeMetaCl4Rename,Markers)
  TreeMetaCl4Rename$metaCl=sapply(TreeMetaCl4Rename$metaCl,function(x){paste(Namings$number[which(Namings$number == x)],
                                                           Namings$option[which(Namings$number == x)],sep="_")})
  return(list(fSOMTree=TreeMetaCl4Rename$fSOMTree,
              metaClNumber=metaClNumber,
              metaCl=TreeMetaCl4Rename$metaCl,
              gatingName=TreeMetaCl4Rename$gatingName))
  }



devtools::document()
